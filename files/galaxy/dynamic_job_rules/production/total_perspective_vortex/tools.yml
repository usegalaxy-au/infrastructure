tools:
  testtoolshed.g2.bx.psu.edu/repos/fubar/htseq_bams_to_count_matrix/htseqsams2mxlocal/.*:
    cores: 3
    mem: 11.5
    rules:
    - id: htseqsams2mxlocal_small_input_rule
      if: input_size < 0.15
      cores: 2
      mem: 7.6
  testtoolshed.g2.bx.psu.edu/repos/jchung/generate_count_matrix/generate_count_matrix/.*:
    cores: 2
    mem: 7.6
  testtoolshed.g2.bx.psu.edu/repos/simon-gladman/phyloseq_filter/biom_filter/.*:
    cores: 16
    mem: 62
  testtoolshed.g2.bx.psu.edu/repos/simon-gladman/phyloseq_ordination_plot/phyloseq_ordinate/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/artbio/cap3/cap3/.*:
    mem: 24
  toolshed.g2.bx.psu.edu/repos/artbio/repenrich/repenrich/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 8
    mem: 30.7
    scheduling:
      prefer:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/artbio/gsc_scran_normalize/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bebatut/cdhit/cd_hit_est/.*:
    cores: 4
    mem: 15.3
    scheduling:
      accept:
      - pulsar
    rules:
    - id: cd_hit_est_small_input_rule
      if: input_size < 0.1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/bebatut/cdhit/cd_hit_protein/.*:
    inherits: toolshed.g2.bx.psu.edu/repos/bebatut/cdhit/cd_hit_est/.*
  toolshed.g2.bx.psu.edu/repos/bgruening/10x_bamtofastq/10x_bamtofastq/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/add_line_to_file/add_line_to_file/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/agat/agat/.*:
    params:
      singularity_enabled: true
    rules:
    - id: agat_large_input
      if: input_size > 0.1
      mem: 32
  toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/align_it/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/antismash/antismash/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/bgruening/augustus/augustus/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: augustus_small_input_rule
      if: input_size < 0.01
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/bgruening/augustus_training/augustus_training/.*:
    params:
      singularity_enabled: false  # TODO: Test with singularity. Built-in tool tests fail by design, testing is difficult.
  toolshed.g2.bx.psu.edu/repos/bgruening/autodock_vina/docking/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/autodock_vina_prepare_box/prepare_box/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/autodock_vina_prepare_ligand/prepare_ligand/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/autodock_vina_prepare_receptor/prepare_receptor/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/bioimage_inference/bioimage_inference/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/bionano_scaffold/bionano_scaffold/.*:
    cores: 16
    mem: 62
    params:
      docker_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/bismark/bismark_.*:
    params:
      singularity_enabled: true
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/bgruening/bismark/bismark_bowtie2/*:
    context:
      max_concurrent_job_count_for_tool_user: 3
  toolshed.g2.bx.psu.edu/repos/bgruening/blobtoolkit/blobtoolkit/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/canu/canu/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
      minimum_singularity_version: '2.2+galaxy0'
    cores: 60
    mem: 961
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
  toolshed.g2.bx.psu.edu/repos/bgruening/cellpose/cellpose/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/chemfp/ctb_chemfp_butina_clustering/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/chemfp/ctb_chemfp_mol2fps/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/chemfp/ctb_chemfp_nxn_clustering/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/chemfp/ctb_sdf2fps/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/chemical_data_sources/ctb_online_data_fetch/.*:
    params:
      singularity_enabled: true
      singularity_container_id_override: /cvmfs/singularity.galaxyproject.org/all/openbabel:2.3.2--py27_2
  toolshed.g2.bx.psu.edu/repos/bgruening/circexplorer/circexplorer/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/cpat/cpat/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/ctb_im_conformers/ctb_im_conformers/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/ctb_im_rxn_maker/ctb_im_rxn_maker/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_coverage/deeptools_bam_coverage/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/.*:
    cores: 10
    mem: 90
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_fingerprint/deeptools_plot_fingerprint/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/.*:
    mem: 40  # TODO: this is down from shared db's 90 but it probably needs even less
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond_makedb/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond_view/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/diff/diff/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/diffbind/diffbind/.*:
    mem: 48
    rules:
      - id: diffbind_medium_input_rule
        if: 1 <= input_size < 7
        mem: 30
      - id: diffbind_small_input_rule
        if: input_size < 1
        mem: 12
      - id: diffbind_singularity_rule
        if: |
          minimum_singularity_version = '3.12.0+galaxy0'
          helpers.tool_version_gte(tool, minimum_singularity_version)
        params:
          singularity_enabled: true
        scheduling:
          accept:
            - pulsar  # older versions might be OK with pulsar but are not OK with singularity
  toolshed.g2.bx.psu.edu/repos/bgruening/enumerate_charges/enumerate_charges/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/find_subsequences/bg_find_subsequences/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/flye/flye/.*:
    context:
      test_cores: 2
      max_concurrent_job_count_for_tool_user: 3
    cores: 60
    mem: 961
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: flye_small_input_rule
      if: input_size < 0.25
      cores: 8
      mem: 30.7
    - id: flye_medium_input_rule
      if: 0.25 <= input_size < 5
      cores: 16
      mem: 150
  toolshed.g2.bx.psu.edu/repos/bgruening/gfastats/gfastats/.*:
    cores: 4
    mem: 15.3
    params:
      singularity_enabled: true 
  toolshed.g2.bx.psu.edu/repos/bgruening/hicexplorer_.*:
    params:
      singularity_enabled: true 
  toolshed.g2.bx.psu.edu/repos/bgruening/hicexplorer_hicbuildmatrix/hicexplorer_hicbuildmatrix/.*:
    cores: 10
    mem: 38.3
  toolshed.g2.bx.psu.edu/repos/bgruening/hicexplorer_hicpca/hicexplorer_hicpca/.*:
    cores: 10
    mem: 38.3
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/hifiasm/hifiasm/.*:
    cores: 60
    mem: 961
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: hifiasm_small_input_rule
      if: input_size < 0.1
      cores: 4
      mem: 15.3
    - id: hifiasm_xlarge_input_rule
      if: input_size > 200
      mem: 1922
      scheduling:
        prefer:
        - pulsar-high-mem1
  toolshed.g2.bx.psu.edu/repos/bgruening/infernal/infernal_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/interproscan/interproscan/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/isescan/isescan/.*:
    cores: 2
    mem: 10
  toolshed.g2.bx.psu.edu/repos/bgruening/itsx/itsx/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/mitohifi/mitohifi/.*:
    cores: 8
    mem: 32 # TODO: this is 8/16 in shared db. If no further problems update this in shared db
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/music_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/nanopolish_eventalign/nanopolish_eventalign/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/bgruening/nanopolish_methylation/nanopolish_methylation/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/bgruening/nanopolish_polya/nanopolish_polya/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/bgruening/nanopolish_variants/nanopolish_variants/.*:
    cores: 5
    mem: 20
  toolshed.g2.bx.psu.edu/repos/bgruening/openbabel.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/pfamscan/pfamscan/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/qed/ctb_silicos_qed/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/racon/racon/.*:
    cores: 60
    mem: 961
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: racon_small_input_rule
      if: input_size < 0.05
      cores: 1
      mem: 3.8
    - id: racon_medium_input_rule
      if: 0.05 <= input_size < 5
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/bgruening/rdconf/rdconf/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/repeat_masker/repeatmasker_wrapper/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 8
    mem: 180
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/bgruening/repeat_masker/repeatmasker_wrapper/4\.1\.5.*:
    params:
      singularity_container_id_override: /cvmfs/singularity.galaxyproject.org/all/repeatmasker:4.1.5--pl5321hdfd78af_0
  toolshed.g2.bx.psu.edu/repos/bgruening/sailfish/sailfish/.*:
    cores: 4
    mem: 15.3
    scheduling:
      accept:
      - pulsar
    rules:
    - id: sailfish_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/bgruening/salmon.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/sdf_to_tab/sdf_to_tab/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/simsearch/ctb_simsearch/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/tapscan/tapscan_classify/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sort_header_tool/.*:
    mem: 10
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sorted_uniq/.*:
    cores: 1
    mem: 3.8
  toolshed.g2.bx.psu.edu/repos/bgruening/trim_galore/trim_galore/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    rules:
    - id: trim_galore_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: trim_galore_medium_input_rule
      if: 0.02 <= input_size < 0.2
      cores: 3
      mem: 11.5
  toolshed.g2.bx.psu.edu/repos/bgruening/wordcloud/wordcloud/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_pca/bio3d_pca/.*:
    mem: 500
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_pca_visualize/bio3d_pca_visualize/.*:
    mem: 64
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_rmsd/bio3d_rmsd/.*:
    mem: 500
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/chemteam/bio3d_rmsf/bio3d_rmsf/.*:
    mem: 500
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/chemteam/biopdb_align_and_rmsd/biopdb_align_and_rmsd/.*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/chemteam/gmx_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/gmx_merge_topology_files/gmx_merge_topology_files/.*:
    rules:
      - id: gmx_merge_topology_files_singularity_rule
        if: |
          minimum_singularity_version = '3.4.3+galaxy0'
          helpers.tool_version_lt(tool, minimum_singularity_version)
        params:
          singularity_enabled: false
  toolshed.g2.bx.psu.edu/repos/chemteam/gmx_sim/gmx_sim/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
    rules:
    - id: gmx_sim_small_input_rule
      if: input_size < 0.01
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/chemteam/mdanalysis_cosine_analysis/mdanalysis_cosine_analysis/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/md_converter/md_converter/.*:
    mem: 16  # TODO: review this, it might not need to be as high
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/md_converter/md_slicer/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/mmpbsa_mmgbsa/mmpbsa_mmgbsa/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/chemteam/vmd_hbonds/vmd_hbonds/.*:
    mem: 10
  toolshed.g2.bx.psu.edu/repos/crs4/prokka/prokka/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: prokka_small_input_rule
      if: input_size < 0.001
      cores: 2
      mem: 7.6
    - id: prokka_fail_rule
      if: input_size >= 0.03
      fail: Too much data, Prokka is designed to annotate bacterial/virus genomes
        only. Prokka will not annotate eukaryotic genomes nor metagenomes.
  toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/.*:
    mem: 12
  toolshed.g2.bx.psu.edu/repos/csbl/repeatmodeler/repeatmodeler/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 16
    mem: 62
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/bamtools/bamtools/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/.*:
    mem: 7.6
  toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 12
    mem: 46.0
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: bowtie2_small_input_rule
      if: input_size < 0.1
      cores: 4
      mem: 15.3
  toolshed.g2.bx.psu.edu/repos/devteam/bowtie_wrappers/bowtie_wrapper/.*:
    inherits: toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/.*
    scheduling:
      require:
        - slurm  # this can run on pulsar but has high input+output size per CPU-time
  toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
      tmp_dir: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: bwa_small_input_rule
      if: input_size < 0.25
      cores: 2
      mem: 7.6
    - id: bwa_medium_input_rule
      if: 0.25 <= input_size < 1
      cores: 4
      mem: 15.3
  toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/.*:
    cores: 60
    mem: 961
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: bwa_mem_small_input_rule
      if: input_size < 0.25
      cores: 2
      mem: 7.6
    - id: bwa_mem_medium_input_rule
      if: 0.25 <= input_size < 1
      cores: 4
      mem: 15.3
    - id: bwa_mem_medium2_input_rule
      if: 1 <= input_size < 20
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    scheduling:
      accept:
      - pulsar
    rules:
    - id: clustalw_fail_rule
      if: input_size >= 0.04
      fail: Too much data, please don't use the clustalw for this.
  toolshed.g2.bx.psu.edu/repos/devteam/cuffdiff/cuffdiff/.*:
    params:
      dependency_resolution: none
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: cuffdiff_large_input_rule
      if: 2 <= input_size
      cores: 4
      mem: 15.3
  toolshed.g2.bx.psu.edu/repos/devteam/cufflinks/cufflinks/.*:
    cores: 5
    mem: 19.1
    scheduling:
      accept:
      - pulsar
    rules:
    - id: cufflinks_small_input_rule
      if: input_size < 0.1
      cores: 1
      mem: 3.8
    - id: cufflinks_medium_input_rule
      if: 0.1 <= input_size < 4
      cores: 3
      mem: 11.5
  toolshed.g2.bx.psu.edu/repos/devteam/cuffmerge/cuffmerge/.*:
    cores: 3
    mem: 11.5
    rules:
    - id: cuffmerge_small_input_rule
      if: input_size < 0.1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/devteam/cuffnorm/cuffnorm/.*:
    cores: 5
    mem: 19.1
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/emboss_5/EMBOSS.*:
    mem: 10
  toolshed.g2.bx.psu.edu/repos/devteam/fastq_groomer/fastq_groomer/.*:
    cores: 2
    mem: 7.6
  toolshed.g2.bx.psu.edu/repos/devteam/fastq_paired_end_deinterlacer/fastq_paired_end_deinterlacer/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: fastq_paired_end_deinterlacer_small_input_rule
      if: input_size < 1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/devteam/fastq_paired_end_interlacer/fastq_paired_end_interlacer/.*:
    cores: 8
    mem: 30.7
    scheduling:  # this can run on pulsar but has high input+output size per CPU-time
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: fastq_paired_end_interlacer_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: fastq_paired_end_interlacer_medium_input_rule
      if: 0.02 <= input_size < 1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/devteam/fastq_paired_end_joiner/fastq_paired_end_joiner/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/devteam/fastq_quality_filter/cshl_fastq_quality_filter/.*:
    cores: 1
    mem: 3.8
    rules:
    - id: cshl_fastq_quality_filter_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: fastqc_singularity_rule
      if: |
        minimum_singularity_version = '0.72+galaxy1'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: fastqc_small_input_rule
      if: input_size < 0.01
      cores: 2
      mem: 7.6
    - id: fastqc_medium_input_rule
      if: 0.01 <= input_size < 2
      cores: 4
      mem: 15.3
    - id: fastqc_large_input_rule
      if: input_size > 20
      scheduling:
        require:
          - slurm
  toolshed.g2.bx.psu.edu/repos/devteam/flanking_features/flanking_features_1/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/devteam/freebayes/bamleftalign/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/devteam/freebayes/freebayes/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: freebayes_small_input_rule
      if: input_size < 0.001
      cores: 2
      mem: 7.6
    - id: freebayes_medium_input_rule
      if: 0.001 <= input_size < 4
      cores: 4
      mem: 15.3
    - id: freebayes_fail_rule
      if: input_size >= 50
      fail: Too much data, please don't use the FreeBayes for this
  toolshed.g2.bx.psu.edu/repos/devteam/gffread/gffread/.*:
    cores: 9
    mem: 34.5
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/join/gops_join_1/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/devteam/kraken/kraken/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 8
    mem: 100
    scheduling:
      accept:
      - pulsar
      - pulsar-high-mem2  # TODO: remove tag when other high memory pulsars are back
  toolshed.g2.bx.psu.edu/repos/devteam/kraken2tax/Kraken2Tax/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/devteam/lastz/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/devteam/lastz/lastz_wrapper_2/.*:
    cores: 16
    mem: 62
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
      - pulsar-quick
    rules:
    - id: lastz_wrapper_2_small_input_rule
      if: input_size < 0.001
      cores: 2
      mem: 7.6
    - id: lastz_wrapper_2_medium_input_rule
      if: 0.001 <= input_size < 1
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastn_wrapper/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: ncbi_blastn_wrapper_pulsar_rule
      if: |
        helpers.job_args_match(job, app, {'db_opts': {'db_opts_selector': 'db'}})
      cores: 15
      mem: int(cores or 1) * 3.1
      scheduling:
        require:
        - pulsar-blast
        accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastp_wrapper/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: ncbi_blastp_wrapper_pulsar_rule
      if: |
        helpers.job_args_match(job, app, {'db_opts': {'db_opts_selector': 'db'}})
      cores: 15
      mem: int(cores or 1) * 3.1
      scheduling:
        require:
        - pulsar-blast
        accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_blastx_wrapper/.*:
    cores: 16
    mem: 62
    rules:
    - id: ncbi_blastx_wrapper_pulsar_rule
      if: |
        helpers.job_args_match(job, app, {'db_opts': {'db_opts_selector': 'db'}})
      cores: 15
      mem: int(cores or 1) * 3.1
      scheduling:
        require:
        - pulsar-blast
        accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_makeblastdb/.*:
    cores: 16
    mem: 62
    rules:
    - id: ncbi_makeblastdb_small_input_rule
      if: input_size < 30
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_segmasker_wrapper/.*:
    cores: 4
    mem: 15.3
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_tblastn_wrapper/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: ncbi_tblastn_wrapper_pulsar_rule
      if: |
        helpers.job_args_match(job, app, {'db_opts': {'db_opts_selector': 'db'}})
      cores: 15
      mem: int(cores or 1) * 3.1
      scheduling:
        require:
        - pulsar-blast
        accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/ncbi_blast_plus/ncbi_tblastx_wrapper/.*:
    cores: 16
    mem: 62
    rules:
    - id: ncbi_tblastx_wrapper_pulsar_rule
      if: |
        helpers.job_args_match(job, app, {'db_opts': {'db_opts_selector': 'db'}})
      cores: 15
      mem: int(cores or 1) * 3.1
      scheduling:
        require:
        - pulsar-blast
        accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/picard/.*:
    cores: 3
    mem: 11.5
    params:
      tmp_dir: true
    scheduling: # these jobs can run on pulsar but it may not be worth transferring them because the job walltime is much quicker than the transport time
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: picard_singularity_rule
      if: |
        minimum_singularity_version = '2.18.2'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: picard_small_input_rule
      if: input_size < 1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/devteam/sam_to_bam/sam_to_bam/.*:
    params:
      singularity_enabled: true
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/devteam/samtool_filter2/samtool_filter2/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/devteam/samtools.*:
    params:
      singularity_enabled: true
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/.*:
    cores: 2
    mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/samtools_markdup/samtools_markdup/.*:
    cores: 4
    mem: 15.3
  toolshed.g2.bx.psu.edu/repos/devteam/samtools_mpileup/samtools_mpileup/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/devteam/samtools_rmdup/samtools_rmdup/.*:
    cores: 2
    mem: 7.6
    params:
      singularity_enabled: true
    scheduling:   # this can run on pulsar but has high input+output size per CPU-time
      accept:
      - pulsar
    rules:
    - id: samtools_rmdup_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/devteam/samtools_sort/samtools_sort/.*:
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/.*:
    cores: 2
    mem: 7.6
  toolshed.g2.bx.psu.edu/repos/devteam/sicer/peakcalling_sicer/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/squirrel_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/squirrel_phylo/squirrel_phylo/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/devteam/tophat2/tophat2/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
    rules:
    - id: tophat2_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/dnbenso/masurca_simple/masurca_simple/.*:
    cores: 8 
    mem: 120
    scheduling:
      prefer:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/earlhaminst/lotus2/lotus2/.*:
    params:
      singularity_enabled: false
  toolshed.g2.bx.psu.edu/repos/ebi-gxa.*:  # singularity for all tools owned by ebi-gxa
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/.*:
    mem: 2 + input_size * 7
    rules:
    - id: anndata_ops_fail_rule
      if: input_size > 30
      fail: Too much data. Total input data must be less than 30GB.
    params:
      singularity_enabled: true
    scheduling:
      accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/.*:
    params:
      singularity_enabled: false
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy.*:
    mem: 4 + input_size * 10
    params:
      singularity_enabled: true
    scheduling:
      accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_multiplet_scrublet/scanpy_multiplet_scrublet/.*:
    mem: 4 + input_size * 65
    rules:
    - id: scanpy_multiplet_scrublet_fail_rule
      if: input_size > 10
      fail: Too much data. Total input data must be less than 10GB.
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_scale_data/scanpy_scale_data/.*:
    mem: 4 + input_size * 32
    rules:
    - id: scanpy_scale_data_fail_rule
      if: input_size > 10
      fail: Too much data. Total input data must be less than 10GB.
  toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_run_pca/scanpy_run_pca/.*:
    mem: 4 + input_size * 10
    rules:
    - id: scanpy_run_pca_fail_rule
      if: input_size > 20
      fail: Too much data. Total input data must be less than 20GB.
  toolshed.g2.bx.psu.edu/repos/ecology/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ecology/pampa_communitymetrics/pampa_communitymetrics/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ecology/pampa_glmcomm/pampa_glmcomm/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ecology/pampa_glmsp/pampa_glmsp/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ecology/pampa_plotglm/pampa_plotglm/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/ecology/pampa_presabs/pampa_presabs/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/.*:
    context:
      alphafold_aa_length_max: 3000
      alphafold_max_input_sequences: 10
      alphafold_db: /data/v2.3
      max_concurrent_job_count_for_tool_user: 4
      pulsar_docker_volumes: $job_directory:ro,$job_directory/home:rw,$tool_directory:ro,$job_directory/outputs:rw,$working_directory:rw,/data/alphafold:/data:ro
    gpus: 1
    cores: 16
    mem: 130
    params:
      docker_enabled: true
      docker_run_extra_arguments: '--gpus all --env ALPHAFOLD_AA_LENGTH_MIN=5 --env ALPHAFOLD_AA_LENGTH_MAX={alphafold_aa_length_max} --env ALPHAFOLD_MAX_SEQUENCES={alphafold_max_input_sequences} --env ALPHAFOLD_DB={alphafold_db}'
      tmp_dir: true
    rules:
    - if: |
        user_has_access = False
        if user is not None:
          user_roles = [role.name for role in user.all_roles() if not role.deleted]
          user_has_access = 'Alphafold_plus' in user_roles
        user_has_access
      context:
        alphafold_aa_length_max: 3000
        alphafold_max_input_sequences: 20
    - if: |
        user_has_access = False
        if user is not None:
          user_roles = [role.name for role in user.all_roles() if not role.deleted]
          user_has_access = 'Alphafold' in user_roles and not 'pulsar_gpu_test' in user_roles
        user_has_access
      scheduling:
        require:
        - pulsar
        - pulsar-qld-gpu-alphafold
        - pulsar-qld-gpu
        accept:
        - training-exempt
    - if: |
        user_has_access = False
        if user is not None:
          user_roles = [role.name for role in user.all_roles() if not role.deleted]
          user_has_access = user.username in [f'qldgpu{x+1}' for x in range(6)] or 'pulsar_gpu_test' in user_roles
        user_has_access
      scheduling:
        accept:
        - pulsar
        require:
        - pulsar-qld-gpu-alphafold
        - pulsar-qld-gpu
    - if: |
        not user or not any([
          role for role in user.all_roles() if (
            role.name in ['Alphafold', 'UoM_Vet_Alphafold', 'pulsar_gpu_test'] and not role.deleted
        )]) and user.username not in [f'qldgpu{x+1}' for x in range(6)]
      fail: |
        This tool is currently being beta-tested on GPUs and your account has not been given access. Contact help@genome.edu.au if you think this is in error.
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/2.1.*:
    inherits: toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/.*
    context:
      alphafold_db: /data/v2.1
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/2.3.*:
    inherits: toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/.*
    rules:
    - if: |
        min_version = '2.3.1+galaxy2'
        helpers.tool_version_gte(tool, min_version)
      context:
        alphafold_db: /data
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/cactus_cactus/cactus_cactus/.*:
    context:
      test_cores: 10
    cores: 24
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/cactus_export/cactus_export/.*:
    context:
      test_cores: 10
    cores: 24
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/hapcut2/hapcut2/.*:
    mem: 8  # TODO: this could be linear on input size
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/hifiadapterfilt/hifiadapterfilt/.*:
    cores: 12
    mem: 46.0
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: hifiadapterfilt_large_input_rule
      if: input_size > 40
      scheduling:
        require:
          - slurm
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/hifiasm_meta/hifiasm_meta/.*:
    cores: 16
    mem: 62
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/kmc/.*:
    cores: 4
    mem: 15.3
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/metawrapmg_binning/metawrapmg_binning/.*:
    context:
      test_cores: 10
    cores: 16
    mem: 64
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/smudgeplot/smudgeplot/.*:
    cores: 8
    mem: 500
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: smudgeplot_fail_rule
      if: input_size > 50
      fail: Too much data. Total input data must be less than 50GB.
  toolshed.g2.bx.psu.edu/repos/galaxyp/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_classification/cardinal_classification/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_combine/cardinal_combine/.*:
    mem: 62
  toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_data_exporter/cardinal_data_exporter/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_preprocessing/cardinal_preprocessing/.*:
    cores: 4
    mem: 80
  toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_quality_report/cardinal_quality_report/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/cardinal_segmentations/cardinal_segmentations/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/custom_pro_db/custom_pro_db/.*:
    mem: 20
    params:
      singularity_enabled: false
  toolshed.g2.bx.psu.edu/repos/galaxyp/diann/diann/.*:
    params:
      docker_enabled: true
      singularity_enabled: false
    rules:
    - id: diann_group_access_rule
      if: |
        not user or not 'diann' in [role.name for role in user.all_roles() if not role.deleted]
      fail: Your account has not been given access to Dia-NN. Contact help@genome.edu.au
        if you think this is in error.
  toolshed.g2.bx.psu.edu/repos/galaxyp/eggnog_mapper.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
      require:
      - eggnog
  toolshed.g2.bx.psu.edu/repos/galaxyp/eggnog_mapper/eggnog_mapper/.*:
    cores: 6
    mem: 23.0
  toolshed.g2.bx.psu.edu/repos/galaxyp/eggnog_mapper/eggnog_mapper_search/.*:
    cores: 4
    mem: 20
  toolshed.g2.bx.psu.edu/repos/galaxyp/encyclopedia_searchtolib/encyclopedia_searchtolib/.*:
    mem: 10
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/galaxyp/fasta_merge_files_and_filter_unique_sequences/fasta_merge_files_and_filter_unique_sequences/.*:
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/galaxyp/flashlfq/flashlfq/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/maldi_quant_peak_detection/maldi_quant_peak_detection/.*:
    mem: 92
  toolshed.g2.bx.psu.edu/repos/galaxyp/maldi_quant_preprocessing/maldi_quant_preprocessing/.*:
    mem: 92
  toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 16
    mem: 65
    scheduling:
      require:
        - pulsar # TODO: change ranking to reneable "prefer" and change this to prefer 
      reject: # reject pulsars without high max_map_count
        - pulsar-high-mem1
        - pulsar-high-mem2
    rules:
      - id: maxquant_singularity_rule
        if: |
          minimum_singularity_version = '2.0.3.0+galaxy0'
          helpers.tool_version_lt(tool, minimum_singularity_version)
        params:
          singularity_enabled: false
  toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant/maxquant_mqpar/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/galaxyp/maxquant_mqpar/maxquant_mqpar/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/galaxyp/morpheus/morpheus/.*:
    params:
      singularity_enabled: true  
    scheduling:
      accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/msconvert/msconvert/.*:
    context:
      partition: msconvert
    cores: 1
    mem: 3.8
    params:
      docker_enabled: true
      singularity_enabled: false
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/galaxyp/openms_openswathworkflow/OpenSwathWorkflow/.*:
    mem: 62
  toolshed.g2.bx.psu.edu/repos/galaxyp/peptideshaker/peptide_shaker/.*:
    cores: 7
    mem: 26.8
  toolshed.g2.bx.psu.edu/repos/galaxyp/pyprophet.*:
    params:
      singularity_enabled: true 
  toolshed.g2.bx.psu.edu/repos/galaxyp/pyprophet_score/pyprophet_score/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/galaxyp/rawtools/rawtools/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/galaxyp/uniprotxml_downloader/uniprotxml_downloader/.*:
    # note: this fails tests with singularity (version 2.4.0)
    mem: 8
  toolshed.g2.bx.psu.edu/repos/genouest/braker3/braker3/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 16
    mem: 62
    params:
      singularity_container_id_override: docker://teambraker/braker3:v1.0.6
      singularity_enabled: true
      singularity_run_extra_arguments: --writable-tmpfs
    scheduling:
      require:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/goeckslab/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/imgteam/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iracooke/protk_proteogenomics/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
      singularity_run_extra_arguments: --writable-tmpfs
  toolshed.g2.bx.psu.edu/repos/iracooke/tpp_prophets/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
      singularity_run_extra_arguments: --writable-tmpfs
  toolshed.g2.bx.psu.edu/repos/iracooke/xtandem/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
      singularity_run_extra_arguments: --writable-tmpfs
  toolshed.g2.bx.psu.edu/repos/iuc/abricate/abricate/.*:
    cores: 8
    mem: 30.7
    # scheduling: # these jobs can run on pulsar but it may not be worth transferring them because the job walltime is much quicker than the transport time
    #   accept:
    #   - pulsar
    #   - pulsar-quick
    rules:
    - id: abricate_small_input_rule
      if: input_size < 0.005
      cores: 1
      mem: 3.8
    - id: abricate_medium_input_rule
      if: 0.005 <= input_size < 0.02
      cores: 4
      mem: 15.3
  toolshed.g2.bx.psu.edu/repos/iuc/abritamr/abritamr/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/abyss/abyss-pe/.*:
    cores: 20
    mem: 320
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
  toolshed.g2.bx.psu.edu/repos/iuc/aegean_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/anndata_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/anndata_import/anndata_import/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/.*:
    mem: 4 + (input_size * 7)
    scheduling:
      accept:
        - pulsar  
    rules:
    - id: anndata_inspect_fail_rule
      if: input_size > 30
      fail: Too much data. Total input data must be less than 30GB.
  toolshed.g2.bx.psu.edu/repos/iuc/annotatemyids/annotatemyids/.*:
    mem: 8
  toolshed.g2.bx.psu.edu/repos/iuc/arriba/arriba/.*:
    cores: 12
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-high-mem2  # TODO: remove tag when other high memory pulsars are back
  toolshed.g2.bx.psu.edu/repos/iuc/arriba_draw_fusions/arriba_draw_fusions/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/arriba_get_filters/arriba_get_filters/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/artic.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/.*:
    mem: 16
    params:
      singularity_enabled: true
    rules:
    - id: bandage_large_input_rule
      if: input_size > 5
      mem: 42
  toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_info/.*:
    inherits: toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/.*
  toolshed.g2.bx.psu.edu/repos/iuc/bakta/bakta/.*:
    context:
      max_concurrent_job_count_for_tool_user: 5
    cores: 8
    mem: 70
    params:
      singularity_enabled: true
    scheduling:
      prefer:
        - cvmfs_cache_100plus
      require:
        - bakta_database
    rules:
    - id: bakta_pulsar_rule
      if: |
        minimum_pulsar_version = '1.9.3+galaxy0'
        helpers.tool_version_gte(tool, minimum_pulsar_version)
      scheduling:
        accept:
          - pulsar
          - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/baredsc_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/barrnap/barrnap/.*:
    cores: 3
    mem: 11.5
    rules:
    - id: barrnap_small_input_rule
      if: input_size < 0.0003
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/bbtools_.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/bcftools_mpileup/bcftools_mpileup/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: bcftools_mpileup_small_input_rule
      if: input_size < 0.5
      cores: 2
      mem: 7.6
    - id: bcftools_mpileup_medium_input_rule
      if: 0.5 <= input_size < 10
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/bcftools_norm/bcftools_norm/.*:
    cores: 2
    mem: 7.6
    rules:
    - id: bcftools_norm_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/beacon2_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools.*:
    mem: 12
  toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/biom_convert/biom_convert/.*:
    mem: 12
  toolshed.g2.bx.psu.edu/repos/iuc/bracken/est_abundance/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/breseq/breseq/.*:
    cores: 4
    mem: 15.3
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/3\.0.*:
    cores: 2
    mem: 7.6
    rules:
    - id: busco_3_large_input_rule
      if: 0.05 <= input_size
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/[^3].*:
    cores: 16
    mem: 150
    scheduling:
      accept:
      - pulsar
      reject:
      - pulsar-qld-high-mem2
    rules:
    - id: busco_singularity_rule
      if: |
        minimum_singularity_version = '5.0.0+galaxy0'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: busco_small_input_rule
      if: input_size < 0.01
      cores: 2
      mem: 7.6
    - id: busco_medium_input_rule
      if: 0.01 <= input_size < 0.3
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/bwa_mem2/bwa_mem2_idx/.*:
    cores: 20
    mem: 250
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
      - training-exempt
  toolshed.g2.bx.psu.edu/repos/iuc/bwa_mem2/bwa_mem2/.*:  # TODO: revisit setting mem based on reference size (https://github.com/usegalaxy-au/infrastructure/issues/1835)
    context:
      max_concurrent_job_count_for_tool_user: 4
      minimum_singularity_version: '2.2.1+galaxy4'
    cores: 20
    mem: 250
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar-quick
      - training-exempt
      prefer:
      - pulsar
    rules:
    # TODO: address effect of reference genome size from data table (particularly aPseCor3hap2)
    #- id: bwa_mem2_small_input_rule
    #  if: input_size < 1
    #  cores: 8
    #  mem: 30.7
    - id: bwa_mem2_medium_input_rule
      if: input_size < 2
      cores: 8
      mem: 100
    - id: bwa_mem2_fail_rule
      if: input_size > 150
      fail: "Too much data: There is a limit of 150GB of input for bwa_mem2 jobs. Please note that bwa_mem2 will accept compressed fastsanger.gz input data. Email help@genome.edu.au with any enquiries."
  toolshed.g2.bx.psu.edu/repos/iuc/bwameth/bwameth/.*:
    params:
      singularity_enabled: true
      tmp_dir: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: bwameth_small_input_rule
      if: input_size < 1
      cores: 4
      mem: 15.3
    - id: bwameth_medium_input_rule
      if: 1 <= input_size < 20
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/cat_bins/cat_bins/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/cemitool/cemitool/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/chira_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/checkm_.*:
    cores: 8
    mem: 120
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      prefer:
      - pulsar-qld-rescue
  toolshed.g2.bx.psu.edu/repos/iuc/chromeister/chromeister/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/.*:
    cores: 2
    mem: 7.6
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/circos/circos_bundlelinks/.*:
    cores: 5
    mem: 19.1
    scheduling:
      accept:
      - pulsar
    rules:
    - id: circos_bundlelinks_small_input_rule
      if: input_size < 0.0002
      cores: 1
      mem: 3.8
    - id: circos_bundlelinks_medium_input_rule
      if: 0.0002 <= input_size < 0.01
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/cite_seq_count/cite_seq_count/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/clair3/clair3/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/cnv_vcf2json/cnv_vcf2json/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/cnvkit_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/collection_column_join/collection_column_join/.*:
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/compleasm/compleasm/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    rules:
    - id: compleasm_small_input_rule
      if: input_size < 1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/control_freec/control_freec/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/coverm_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/dada2_assigntaxonomyaddspecies/dada2_assignTaxonomyAddspecies/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/.*:
    cores: 2
    mem: 10
  toolshed.g2.bx.psu.edu/repos/iuc/dada2_filterandtrim/dada2_filterAndTrim/.*:
    cores: 2
    mem: 10
  toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/.*:
    cores: 2
    mem: 10
  toolshed.g2.bx.psu.edu/repos/iuc/datamash_ops/datamash_ops/.*:
    cores: 1
    mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/deg_annotate/deg_annotate/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/deseq2/deseq2/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
    scheduling:
      accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/dexseq/dexseq/.*:
    cores: 9
    mem: 34.5
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/dexseq/dexseq_count/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/dexseq/plotdexseq/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/dropletutils/dropletutils/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/edger/edger/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/ega_download_client/pyega3/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/egsea/egsea/.*:
    mem: 8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/ena_upload/ena_upload/.*:
    params:
      singularity_enabled: false  # 21/3/24: testing ena_upload with singularity_enabled not true
  toolshed.g2.bx.psu.edu/repos/iuc/episcanpy_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/exonerate/exonerate/.*:
    cores: 30
    mem: 480.5
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/export2graphlan/export2graphlan/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/falco/falco/.*:
    cores: 6
    mem: 23
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/fasta_stats/fasta-stats/.*:
    mem: min(3 * input_size + 2, 40)
  toolshed.g2.bx.psu.edu/repos/iuc/fastani/fastani/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 4
    mem: 15.3
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/feelnc/feelnc/.*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/iuc/filtlong/filtlong/.*:
    mem: 12  # TODO: this overrides tpv shared entry giving 50G to each job. It could be changed to a linear function of input size
    rules:
    - id: filtlong_small_input_rule
      if: input_size < 1
      mem: 6
  toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/fastplong/fastplong/.*:
    cores: 8
    mem: 31
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/funannotate.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
        - pulsar
      require:
        - funannotate  # both funannotate dbs in /mnt/custom-indices on destination VM
    rules:
      - id: funnannotate_v1_8_17_container_override_rule
        if: tool.version.startswith('1.8.17')
        params:
          singularity_container_id_override: /cvmfs/singularity.galaxyproject.org/all/funannotate:1.8.17--pyhdfd78af_1
  toolshed.g2.bx.psu.edu/repos/iuc/funannotate_compare/funannotate_compare/.*:
    cores: 8
    mem: 40
    rules:
    - id: funannotate_compare_large_input
      if: input_size > 3.2
      mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/funannotate_predict/funannotate_predict/.*:
    cores: 8
    mem: 30.7
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/gecko/gecko/.*:
    cores: 8
    mem: 30.7
    rules:
    - id: gecko_small_input_rule
      if: input_size < 0.1
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/gem_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/gemini_load/gemini_load/.*:
    cores: 3
    mem: 11.5
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/geneiobio/gene_iobio_display_generation_iframe/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/getorganelle/get_annotated_regions_from_gb/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/getorganelle/get_organelle_from_reads/.*:
    mem: 70
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
      - id: get_organelle_from_reads_large_input_rule
        if: input_size > 2
        mem: 120
  toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap2/ggplot2_heatmap2/.*:
    mem: 12
    rules:
      - id: ggplot2_heatmap2_large_input_rule
        if: input_size > 0.001
        mem: 24
  toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_point/ggplot2_point/.*:
    cores: 1
    mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/goseq/goseq/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/gprofiler_gost/gprofiler_gost/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/graphlan_annotate/graphlan_annotate/.*:
    mem: 12
  toolshed.g2.bx.psu.edu/repos/iuc/gtdbtk_classify_wf/gtdbtk_classify_wf/.*:
    cores: 32
    mem: 122.8
    params:
      singularity_enabled: true
    scheduling:
      require:
      - gtdbtk_database
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/gtftobed12/gtftobed12/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/gubbins/gubbins/.*:
    cores: 16
    mem: 62
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: gubbins_small_input_rule
      if: input_size < 0.0005
      cores: 5
      mem: 19.1
    - id: gubbins_fail_rule
      if: input_size >= 0.5
      fail: Too much data, please don't use the gubbins for this.
  toolshed.g2.bx.psu.edu/repos/iuc/hisat2/hisat2/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    params:
      tmp_dir: true
    rules:
    - id: hisat2_small_input_rule
      if: input_size < 0.5
      cores: 2
      mem: 7.6
    - id: hisat2_medium_input_rule
      if: 0.5 <= input_size < 12
      cores: 8
      mem: 30.7
    - id: hisat2_large_input_rule
      if: input_size >= 12
      cores: 36
      mem: 500
      scheduling:
        accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/humann/humann/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 16
    mem: 62
    rules:
    - id: humann_small_input_rule
      if: input_size < 0.01
      cores: 5
      mem: 19
    - id: humann_medium_input_rule
      if: 0.01 <= input_size < 10
      cores: 7
      mem: 45
    - id: humann_singularity_rule
      if: |
        minimum_singularity_version = '3.7+galaxy0'
        # Unable to run tool tests on previous versions. They might work. TODO: test these manually
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/humann_*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/iuc/humann2/humann2/.*:
    cores: 6
    mem: 150
    context:
      max_concurrent_job_count_for_tool_user: 4
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-high-mem2  # TODO: remove tag when other high memory pulsars are back
  toolshed.g2.bx.psu.edu/repos/iuc/hybpiper/hybpiper/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/hyphy_absrel/hyphy_absrel/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/hyphy_gard/hyphy_gard/.*:
    cores: 20
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: hyphy_gard_small_input_rule
      if: input_size < 0.000005
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/idr_download_by_ids/idr_download_by_ids/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/iedb_api/iedb_api/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/iqtree/iqtree/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: iqtree_small_input_rule
      if: input_size < 0.000002
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/isoformswitchanalyzer/isoformswitchanalyzer/.*:
    mem: 10  
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/ivar_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/ivar_consensus/ivar_consensus/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/ivar_trim/ivar_trim/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/ivar_variants/ivar_variants/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/iwtomics_loadandplot/iwtomics_loadandplot/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/jbrowse/jbrowse/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/jcvi_gff_stats/jcvi_gff_stats/.*:
    mem: 8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/jellyfish/jellyfish/.*:
    mem: 24
    scheduling:
      accept:
      - pulsar
    rules:
    - id: jellyfish_small_input_rule
      if: input_size < 0.1
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/jvarkit_wgscoverageplotter/jvarkit_wgscoverageplotter/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/kallisto_quant/kallisto_quant/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    rules:
    - id: kallisto_quant_small_input_rule
      if: input_size < 0.1
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/khmer_abundance_distribution_single/khmer_abundance_distribution_single/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: khmer_abundance_distribution_single_small_input_rule
      if: input_size < 0.1
      cores: 2
      mem: 7.6
    - id: khmer_abundance_distribution_single_medium_input_rule
      if: 0.1 <= input_size < 0.5
      cores: 16
      mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/kraken.*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    # Galaxy Main's kraken2 memory rule
    cores: 16
    mem: |
      import os
      mem = 64
      table_name = "kraken2_databases"
      lookup_column = "value"
      value_column = "path"
      value_template = "{value}/hash.k2d"
      options = job.get_param_values(app)
      lookup_value = options["kraken2_database"]
      table_value = app.tool_data_tables.get(table_name).get_entry(lookup_column, lookup_value, value_column)
      if table_value is not None:
          table_value = value_template.format(value=table_value)
          try:
              mem = int(os.path.getsize(table_value)/1024**3 * 1.2)
              log.debug("Data table '%s' lookup '%s=%s: %s=%s': %s GB",
                        table_name, lookup_column, lookup_value, value_column, table_value, mem)
          except OSError:
              log.exception("Failed to get size of: %s", table_value)
      else:
          log.warning("Data table '%s' lookup '%s=%s: %s=None' returned None!, defaulting to %s",
                      table_name, lookup_column, lookup_value, value_column, mem)
      min(mem + 48, 980)
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
      - pulsar-high-mem2  # TODO: remove tag when other high memory pulsars are back
      prefer:
      - cvmfs_cache_100plus
      reject:
      - pulsar-QLD
    rules:
    - id: kraken2_reference_training_rule
      # apply training rules exemption unless the database is minikraken2
      if: |
        minikraken2_db_key = '2020-02-05T235531Z_minikraken2_v2_8GB'
        not helpers.job_args_match(job, app, {'kraken2_database': minikraken2_db_key})
      scheduling:
        accept:
        - training-exempt
  toolshed.g2.bx.psu.edu/repos/iuc/kraken_biom/kraken_biom/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/krakentools_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/krakentools_extract_kraken_reads/krakentools_extract_kraken_reads/.*:
    mem: 10
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/length_and_gc_content/.*:
    mem: 10
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/limma_voom/limma_voom/.*:
    cores: 7
    mem: 26.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/links/links/.*:
    cores: 4
    mem: 15.3
  toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/lofreq_filter/lofreq_filter/.*:
    cores: 4
    mem: 15.3
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/lofreq_indelqual/lofreq_indelqual/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/.*:
    cores: 4
    mem: 15.3
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_bdgcmp/.*:
    mem: 12
  toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_bdgdiff/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/maker/maker/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 8
    mem: 30.39
    env:
      MAKER_MPI: '1'
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/medaka_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus/medaka_consensus/.*:
    cores: 4
    mem: 15.3
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/medaka_consensus_pipeline/medaka_consensus_pipeline/.*:
    cores: 20
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: medaka_consensus_pipeline_small_input_rule
      if: input_size < 0.5
      cores: 4
      mem: 15.3
    - id: medaka_consensus_pipeline_medium_input_rule
      if: 0.5 <= input_size < 5
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/medaka_variant/medaka_variant/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: medaka_variant_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/megahit/megahit/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3  # TODO: this tool could go to high memory pulsars instead
    cores: 16
    mem: 62
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: megahit_small_input_rule
      if: input_size < 5
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/megahit_contig2fastg/megahit_contig2fastg/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/megan_sam2rma/megan_sam2rma/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/merqury/merqury/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: merqury_small_input_rule
      if: input_size < 0.001
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/meryl/meryl/.*:
    cores: 60
    mem: 961
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: meryl_small_input_rule
      if: input_size < 0.001
      cores: 2
      mem: 7.6
    - id: meryl_medium_input_rule
      if: 0.001 <= input_size < 5
      cores: 16
      mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/metaphlan/metaphlan/.*:
    cores: 8
    mem: 31
  toolshed.g2.bx.psu.edu/repos/iuc/metaphlan2/metaphlan2/.*:
    inherits: toolshed.g2.bx.psu.edu/repos/iuc/metaphlan/metaphlan/.*
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/minimap2/minimap2/.*:
    cores: 30
    mem: 480.5
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: minimap2_small_input_rule
      if: input_size < 0.5
      cores: 4
      mem: 24
    - id: minimap2_medium_input_rule
      if: 0.5 <= input_size < 20
      cores: 16
      mem: 120
  toolshed.g2.bx.psu.edu/repos/iuc/mitobim/mitobim/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/mitos2/mitos2/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/modify_loom/modify_loom/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/mosdepth/mosdepth/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/mothur.*:
    params:
      docker_enabled: true
      docker_run_extra_arguments: --pids-limit 10000 --ulimit fsize=1000000000 --env
        TERM=vt100
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_align_seqs/mothur_align_seqs/.*:
    cores: 12
    mem: 46.0
    rules:
    - id: mothur_align_seqs_small_input_rule
      if: input_size < 0.02
      cores: 2
      mem: 7.6
    - id: mothur_align_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_chimera_vsearch/mothur_chimera_vsearch/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_chimera_vsearch_small_input_rule
      if: input_size < 0.02
      cores: 2
      mem: 7.6
    - id: mothur_chimera_vsearch_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_classify_otu/mothur_classify_otu/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_classify_otu_small_input_rule
      if: input_size < 0.02
      cores: 2
      mem: 7.6
    - id: mothur_classify_otu_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_classify_seqs/mothur_classify_seqs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_classify_seqs_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_classify_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_cluster_split/mothur_cluster_split/.*:
    cores: 24
    mem: 800
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
      prefer:
      - pulsar-qld-high-mem2
      - pulsar-qld-rescue
    rules:
    - id: mothur_cluster_split_medium_input_rule
      if: 0.00015 <= input_size < 0.1
      cores: 8
      mem: 100
    - id: mothur_cluster_split_small_input_rule
      if: input_size < 0.00015
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_count_seqs/mothur_count_seqs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_count_seqs_small_input_rule
      if: input_size < 0.02
      cores: 2
      mem: 7.6
    - id: mothur_count_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_dist_shared/mothur_dist_shared/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_dist_shared_small_input_rule
      if: input_size < 0.002
      cores: 1
      mem: 3.8
    - id: mothur_dist_shared_medium_input_rule
      if: 0.002 <= input_size < 0.005
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_filter_seqs/mothur_filter_seqs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_filter_seqs_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_filter_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_make_biom/mothur_make_biom/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_make_contigs/mothur_make_contigs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_make_contigs_small_input_rule
      if: input_size < 0.02
      cores: 2
      mem: 7.6
    - id: mothur_make_contigs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_make_group/mothur_make_group/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_make_group_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_make_group_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_make_shared/mothur_make_shared/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_make_shared_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_make_shared_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_merge_files/mothur_merge_files/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_merge_files_small_input_rule
      if: input_size < 0.02
      cores: 3
      mem: 11.5
    - id: mothur_merge_files_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_pre_cluster/mothur_pre_cluster/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_pre_cluster_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_pre_cluster_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_screen_seqs/mothur_screen_seqs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_screen_seqs_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_screen_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_summary_seqs/mothur_summary_seqs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_summary_seqs_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_summary_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_taxonomy_to_krona/mothur_taxonomy_to_krona/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_taxonomy_to_krona_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_taxonomy_to_krona_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_unique_seqs/mothur_unique_seqs/.*:
    cores: 7
    mem: 26.8
    rules:
    - id: mothur_unique_seqs_small_input_rule
      if: input_size < 0.02
      cores: 1
      mem: 3.8
    - id: mothur_unique_seqs_medium_input_rule
      if: 0.02 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mothur_venn/mothur_venn/.*:  # does not work on pulsar
      mem: 2
  toolshed.g2.bx.psu.edu/repos/iuc/multigsea/multigsea/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/mummer.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/mummer_mummer/mummer_mummer/.*:
    cores: 5
    mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/mummer_nucmer/mummer_nucmer/.*:
    cores: 5
    mem: 19.1
    # This tool was running on pulsar with singularity_enabled: true until July '25 because the latest version
    # (4.0.0+galaxy1) does not pass all of its tests with the singularity container but does pass
    # them with the conda environment, unlike previous versions
    params:
      singularity_enabled: false
    rules:
    - id: mummer_nucmer_small_input_rule
      if: input_size < 0.01
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/nanoplot/nanoplot/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/ncbi_fcs_gx/ncbi_fcs_gx/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: ncbi_fcs_gx_job_parameter_rule
      if: |
        helpers.job_args_match(job, app, {"mode": {"mode_selector": "screen"}})
      mem: 480
      cores: 30  # EU gave it 64 cores
  toolshed.g2.bx.psu.edu/repos/iuc/nextclade/nextclade/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/pathview/pathview/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/pear/iuc_pear/.*:
    cores: 7
    mem: 26.8
    scheduling:
      accept:
      - pulsar
    rules:
    - id: iuc_pear_small_input_rule
      if: input_size < 0.015
      cores: 1
      mem: 3.8
    - id: iuc_pear_medium_input_rule
      if: 0.015 <= input_size < 1
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/pharokka/pharokka/.*:
    cores: 8
    mem: 31
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/phyloseq_from_dada2/phyloseq_from_dada2/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/phyml/phyml/.*:
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/picrust.*:
    cores: 2
    mem: 10
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_add_descriptions/picrust2_add_descriptions/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_hsp/picrust2_hsp/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_metagenome_pipeline/picrust2_metagenome_pipeline/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_pathway_pipeline/picrust2_pathway_pipeline/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_pipeline/picrust2_pipeline/.*:
    cores: 8
    mem: 31.2
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_place_seqs/picrust2_place_seqs/.*:
    cores: 8
    mem: 31.2
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust2_shuffle_predictions/picrust2_shuffle_predictions/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust_categorize/picrust_categorize/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust_compare_biom/picrust_compare_biom/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust_format_tree_and_trait_table/picrust_format_tree_and_trait_table/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust_metagenome_contributions/picrust_metagenome_contributions/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust_normalize_by_copy_number/picrust_normalize_by_copy_number/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/picrust_predict_metagenomes/picrust_predict_metagenomes/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/pilon/pilon/.*:
    cores: 16
    mem: 62
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: pilon_small_input_rule
      if: input_size < 4
      cores: 9
      mem: 34.5
  toolshed.g2.bx.psu.edu/repos/iuc/plasflow/PlasFlow/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/plasmidfinder/plasmidfinder/.*:
    cores: 6
    mem: 23
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/polypolish/polypolish/.*:
    mem: 23
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/porechop/porechop/.*:
    mem: 70
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-high-mem2  # TODO: remove tag when other high memory pulsars are back
    rules:
    - id: porechop_small_input_rule
      if: input_size < 0.8
      mem: 12
    - id: porechop_large_input_rule
      if: input_size > 8
      mem: 240
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_events/poretools_events/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_extract/poretools_extract/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_hist/poretools_hist/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_nucdist/poretools_nucdist/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_occupancy/poretools_occupancy/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_qualdist/poretools_qualdist/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_qualpos/poretools_qualpos/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_squiggle/poretools_squiggle/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_stats/poretools_stats/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_tabular/poretools_tabular/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_times/poretools_times/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_winner/poretools_winner/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/poretools_yield_plot/poretools_yield_plot/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/prodigal/prodigal/.*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/iuc/purge_dups/purge_dups/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/qualimap_.*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/iuc/qualimap_bamqc/qualimap_bamqc/.*:
    cores: 5
    mem: 34.5
    params:
      singularity_enabled: true
    rules:
    - id: qualimap_bamqc_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: qualimap_bamqc_medium_input_rule
      if: 0.2 <= input_size < 2
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/qualimap_multi_bamqc/qualimap_multi_bamqc/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/qualimap_rnaseq/qualimap_rnaseq/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/quast/quast/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 16
    mem: 62
    rules:
    - id: quast_small_input_rule
      if: input_size < 0.01
      cores: 2
      mem: 10
    - id: quast_medium_input_rule
      if: 0.01 <= input_size < 1
      cores: 4
      mem: 16
    - id: quast_singularity_rule
      if: |
        minimum_singularity_version = '5.3.0+galaxy0'  # TODO: test older versions with singularity
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/qiime_extract_viz/qiime_extract_viz/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/raceid_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/ragtag/ragtag/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    rules:
    - id: ragtag_small_input_rule
      if: input_size < 0.2
      cores: 4
      mem: 15.3
    - id: ragtag_large_input_rule
      if: input_size > 1.4
      cores: 8
      mem: 200
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/rapidnj/rapidnj/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/raven/raven/.*:
    cores: 20
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: raven_small_input_rule
      if: input_size < 0.002
      cores: 2
      mem: 7.6
    - id: raven_medium_input_rule
      if: 0.002 <= input_size < 5
      cores: 16
      mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/raxml/raxml/.*:
    cores: 24
    mem: 250
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: raxml_small_input_rule
      if: input_size < 0.0005
      cores: 2
      mem: 7.6
    - id: raxml_medium_input_rule
      if: 0.0005 <= input_size < 0.1
      cores: 16
      mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/recentrifuge/recentrifuge/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/red/red/.*:
    mem: 8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/rgrnastar/rna_star/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 12
    mem: 46.0
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/rna_starsolo/rna_starsolo/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/rnaspades/rnaspades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: rnaspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: rnaspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/rnaquast/rna_quast/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/roary/roary/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/salsa/salsa/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/samtools.*:
    params:
      singularity_enabled: true
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_cluster_reduce_dimension/scanpy_cluster_reduce_dimension/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    rules:
    - id: scanpy_cluster_reduce_dimension_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_filter/scanpy_filter/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
    rules:
    - id: scanpy_filter_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
    rules:
    - id: scanpy_inspect_small_input_rule
      if: input_size < 0.5
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_normalize/scanpy_normalize/.*:
    cores: 2
    mem: 7.6
    params:
      singularity_enabled: true
    rules:
    - id: scanpy_normalize_small_input_rule
      if: input_size < 1
      cores: 1
      mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/.*:
    mem: 4 + input_size * 16
    params:
      singularity_enabled: true
    scheduling:
      accept:
        - pulsar
    rules:
    - id: scanpy_plot_fail_rule
      if: input_size > 30
      fail: Too much data. Total input data must be less than 30GB.
  toolshed.g2.bx.psu.edu/repos/iuc/scanpy_remove_confounders/scanpy_remove_confounders/.*:
    cores: 9
    mem: 34.5
    params:
      singularity_enabled: true
    rules:
    - id: scanpy_remove_confounders_small_input_rule
      if: input_size < 0.05
      cores: 1
      mem: 3.8
    - id: scanpy_remove_confounders_medium_input_rule
      if: 0.05 <= input_size < 0.5
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/scater_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/sceasy_convert/sceasy_convert/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/seq2hla/seq2hla/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/schicexplorer_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/seqkit_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/seqtk/seqtk_seq/.*:
    cores: 20
    mem: 200
    scheduling:
      accept:
      - pulsar
    rules:
    - id: seqtk_seq_small_input_rule
      if: input_size < 10
      cores: 1
      mem: 3.8
    - id: seqtk_seq_medium_input_rule
      if: 10 <= input_size < 20
      cores: 4
      mem: 15.3
  toolshed.g2.bx.psu.edu/repos/iuc/seurat.*:
    mem: 10
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/shasta/shasta/.*:
    cores: 20
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
      - pulsar-training-large
    rules:
    - id: shasta_small_input_rule
      if: input_size < 0.002
      cores: 2
      mem: 7.6
    - id: shasta_medium_input_rule
      if: 0.002 <= input_size < 5
      cores: 16
      mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/shovill/shovill/.*:
    cores: 10
    mem: 38.3
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
    rules:
    - id: shovill_small_input_rule
      if: input_size < 0.015
      cores: 1
      mem: 3.8
    - id: shovill_medium_input_rule
      if: 0.015 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: shovill_fail_rule
      if: input_size >= 10
      fail: Your input data exceeds 10GB and therefore is not suitable for Shovill.
  toolshed.g2.bx.psu.edu/repos/iuc/sinto_.*:
    params:
      singularity_enabled: true 
  toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_.*:
    params:
      singularity_enabled: true 
  toolshed.g2.bx.psu.edu/repos/iuc/snippy/snippy/.*:
    cores: 6
    mem: 23
    params:
      singularity_enabled: true
      tmp_dir: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: snippy_small_input_rule
      if: input_size < 0.015
      cores: 3
      mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/snippy/snippy_core/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/snp_dists/snp_dists/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff.*:
    params:
      singularity_enabled: true  
  toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_get_chr_names/.*:
    params:
      singularity_enabled: false  # both installed versions pass tests without singularity enabled, fail 1/2 with singularity enabled
  toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_annotate/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/spades_biosyntheticspades/spades_biosyntheticspades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 20
    mem: 500
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_biosyntheticspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_biosyntheticspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: spades_biosyntheticspades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/iuc/spades_coronaspades/spades_coronaspades/.*:
    cores: 20
    mem: 500
    scheduling:
      accept:
      - pulsar-paw
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_coronaspades_singularity_rule
      if: |
        minimum_singularity_version = '3.15.4+galaxy0'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: spades_coronaspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_coronaspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: spades_coronaspades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/iuc/spades_metaplasmidspades/spades_metaplasmidspades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 20
    mem: 500
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_metaplasmidspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_metaplasmidspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: spades_metaplasmidspades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/iuc/spades_metaviralspades/spades_metaviralspades/.*:
    cores: 20
    mem: 500
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_metaviralspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_metaviralspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: spades_metaviralspades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/iuc/spades_plasmidspades/spades_plasmidspades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 20
    mem: 500
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_plasmidspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_plasmidspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: spades_plasmidspades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/iuc/spades_rnaviralspades/spades_rnaviralspades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 10
    mem: 250
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_rnaviralspades_singularity_rule
      if: |
        minimum_singularity_version = '3.15.4+galaxy1'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: spades_rnaviralspades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_rnaviralspades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 3
    mem: 11.5
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fastq_dump/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 3
    mem: 11.5
    params:
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/sam_dump/.*:
    cores: 3
    mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/stacks.*:
    cores: 2
    mem: 10
  toolshed.g2.bx.psu.edu/repos/iuc/stacks_denovomap/stacks_denovomap/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_cstacks/stacks2_cstacks/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_denovomap/stacks2_denovomap/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_gstacks/stacks2_gstacks/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_populations/stacks2_populations/.*:
    cores: 8
    mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_refmap/stacks2_refmap/.*:
    cores: 8
    mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_sstacks/stacks2_sstacks/.*:
    cores: 16
    mem: 62
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_tsv2bam/stacks2_tsv2bam/.*:
    cores: 16
    mem: 80
  toolshed.g2.bx.psu.edu/repos/iuc/stacks2_ustacks/stacks2_ustacks/.*:
    cores: 16
    mem: 100
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/stringtie/stringtie/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: stringtie_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: stringtie_medium_input_rule
      if: 0.2 <= input_size < 2
      cores: 3
      mem: 11.5
  toolshed.g2.bx.psu.edu/repos/iuc/stringtie/stringtie_merge/.*:
    cores: 1
    mem: 3.8
  toolshed.g2.bx.psu.edu/repos/iuc/tetoolkit_tetranscripts/tetoolkit_tetranscripts/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/transit_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/trinity.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/trinity/trinity/.*:
    cores: 60
    mem: 961
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: trinity_small_input_rule
      if: input_size < 0.1
      cores: 8
      mem: 30.7
    - id: trinity_fail_rule
      if: input_size >= 30
      fail: Too much data, we cannot support such large Trinity assemblies with our
        backend. Please use another server for your job.
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_abundance_estimates_to_matrix/trinity_abundance_estimates_to_matrix/.*:
    mem: 8
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_align_and_estimate_abundance/trinity_align_and_estimate_abundance/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_analyze_diff_expr/trinity_analyze_diff_expr/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_contig_exn50_statistic/trinity_contig_exn50_statistic/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_filter_low_expr_transcripts/trinity_filter_low_expr_transcripts/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_gene_to_trans_map/trinity_gene_to_trans_map/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_run_de_analysis/trinity_run_de_analysis/.*:
    mem: 15
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/trinity_samples_qccheck/trinity_samples_qccheck/.*:
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/iuc/trycycler.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/trycycler_cluster/trycycler_cluster/.*:
    cores: 9
    mem: 34.5
    rules:
    - id: trycycler_cluster_small_input_rule
      if: input_size < 0.1
      cores: 1
      mem: 3.8
    - id: trycycler_cluster_medium_input_rule
      if: 0.2 <= input_size < 3
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/trycycler_consensus/trycycler_consensus/.*:
    cores: 16
    mem: 62
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: trycycler_consensus_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: trycycler_consensus_medium_input_rule
      if: 0.2 <= input_size < 2
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/trycycler_partition/trycycler_partition/.*:
    cores: 9
    mem: 34.5
    rules:
    - id: trycycler_partition_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: trycycler_partition_medium_input_rule
      if: 0.2 <= input_size < 3
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/trycycler_reconcile_msa/trycycler_reconcile_msa/.*:
    cores: 9
    mem: 34.5
    rules:
    - id: trycycler_reconcile_msa_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: trycycler_reconcile_msa_medium_input_rule
      if: 0.2 <= input_size < 3
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/trycycler_subsample/trycycler_subsample/.*:
    cores: 9
    mem: 34.5
    rules:
    - id: trycycler_subsample_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: trycycler_subsample_medium_input_rule
      if: 0.2 <= input_size < 3
      cores: 5
      mem: 19.1
  toolshed.g2.bx.psu.edu/repos/iuc/ucsc_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/umi_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/umi_tools_dedup/umi_tools_dedup/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: umi_tools_dedup_small_input_rule
      if: input_size < 0.2
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/iuc/unicycler/unicycler/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 16
    mem: 150
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
      - pulsar-training-large
      - pulsar-high-mem2  # TODO: remove tag when other high memory pulsars are back
    rules:
    - id: unicycler_singularity_rule
      if: |
        minimum_singularity_version = '0.5.0+galaxy0'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: unicycler_small_input_rule
      if: input_size < 0.05
      cores: 2
      mem: 7.6
    - id: unicycler_medium_input_rule
      if: 0.05 <= input_size < 0.3
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/iuc/ucsc_wigtobigwig/ucsc_wigtobigwig/.*:
    inherits: wig_to_bigWig
  toolshed.g2.bx.psu.edu/repos/iuc/varscan_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/vcf2maf/vcf2maf/.*:
    cores: 6
    mem: 23.0
  toolshed.g2.bx.psu.edu/repos/iuc/velocyto_cli/velocyto_cli/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/verkko/verkko/.*:
    cores: 16
    mem: 62
    # params:
    #   singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/vsearch/.*:
    mem: 8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/windowmasker/windowmasker_mkcounts/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/windowmasker/windowmasker_ustat/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/yahs/yahs/.*:
    mem: 200
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: cutadapt_singularity_rule
      if: |
        minimum_singularity_version = '4.0+galaxy0'  # earlier versions have not been tested and might work
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/lparsons/htseq_count/htseq_count/.*:
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
      tmp_dir: true
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: htseq_count_small_input_rule
      if: input_size < 0.2
      cores: 1
      mem: 3.8
    - id: htseq_count_medium_input_rule
      if: 0.2 <= input_size < 10
      cores: 8
      mem: 30.7
  toolshed.g2.bx.psu.edu/repos/mbernt/maxbin2/maxbin2/.*:
    cores: 12
    mem: 46.0
  toolshed.g2.bx.psu.edu/repos/mvdbeek/add_input_name_as_column/addName/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/rseqc_bam_stat/.*:
    mem: 8
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/rseqc_RPKM_saturation/.*:
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/rseqc_geneBody_coverage/.*:
    cores: 2
    mem: 7.6
    scheduling:
      accept:
      - pulsar
    rules:
    - id: rseqc_geneBody_coverage_small_input_rule
      if: input_size < 0.5
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/rseqc_geneBody_coverage2/.*:
    cores: 2
    mem: 7.6
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/rseqc_read_distribution/.*:
    cores: 2
    mem: 7.6
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/nilesh/rseqc/rseqc_read_duplication/.*:
    mem: 8
  toolshed.g2.bx.psu.edu/repos/nml/csvtk_.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/nml/metaspades/metaspades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 3
    cores: 16
    mem: 62
    params:
      singularity_enabled: true
      tmp_dir: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: metaspades_small_input_rule
      if: input_size < 0.05
      cores: 2
      mem: 7.6
    - id: metaspades_medium_input_rule
      if: 0.05 <= input_size < 1
      cores: 8
      mem: 30.7
    - id: metaspades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/nml/mob_suite/.*:
    params:
      singularity_enabled: true
    # scheduling:  # This is a good pulsar tool but galaxy has been going bananas trying to build the container locally prior to sending jobs to pulsar. Fascinating.
    #   accept:
    #     - pulsar
    #     - pulsar-quick
  toolshed.g2.bx.psu.edu/repos/nml/mob_suite/mob_recon/.*:
    rules:
      - id: mob_recon_large_input_rule
        if: input_size > 0.004
        cores: 2
        mem: 7.6
  toolshed.g2.bx.psu.edu/repos/nml/spades/spades/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 20
    mem: 500
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
      - pulsar-training-large
    rules:
    - id: spades_small_input_rule
      if: input_size < 0.005
      cores: 2
      mem: 7.6
    - id: spades_medium_input_rule
      if: 0.005 <= input_size < 2
      cores: 8
      mem: 30.7
    - id: spades_fail_rule
      if: input_size >= 60
      fail: Too much data, please don't use Spades for this
  toolshed.g2.bx.psu.edu/repos/nml/quasitools/.*:
      mem: 8
  toolshed.g2.bx.psu.edu/repos/padge/clipkit/clipkit/.*: {}  # no singularity container, works with conda
  toolshed.g2.bx.psu.edu/repos/perssond/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/peterjc/sample_seqs/sample_seqs/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/peterjc/seq_filter_by_id/seq_filter_by_id/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/peterjc/seq_select_by_id/seq_select_by_id/.*:
    mem: 12
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/pjbriggs/macs21/macs2_1_peakcalling/.*:
    cores: 9
    mem: 34.5
  toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/.*:
    cores: 3
    mem: 11.5
    scheduling:
      accept:
      - pulsar
      - pulsar-quick
    rules:
    - id: trimmomatic_singularity_rule
      if: |
        minimum_singularity_version = '0.36.6'
        helpers.tool_version_gte(tool, minimum_singularity_version)
      params:
        singularity_enabled: true
    - id: trimmomatic_small_input_rule
      if: input_size < 0.015
      cores: 1
      mem: 3.8
    - id: trimmomatic_medium_input_rule
      if: 0.015 <= input_size < 3
      cores: 2
      mem: 7.6
  toolshed.g2.bx.psu.edu/repos/q2d2/qiime2.*:
    params:
      docker_enabled: true
      tmp_dir: true
  toolshed.g2.bx.psu.edu/repos/q2d2/qiime2__longitudinal__nmit/qiime2__longitudinal__nmit/.*:
    mem: 8
  toolshed.g2.bx.psu.edu/repos/recetox/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/rnateam/chipseeker/chipseeker/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/rnateam/mirdeep2.*:
    mem: 8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/rnateam/mirdeep2_mapper/rbc_mirdeep2_mapper/.*:
    mem: 28
    scheduling:
      accept:
        - pulsar
  toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 8
    mem: 30.7
    scheduling:
      accept:
      - pulsar
    rules:
    - id: rbc_mafft_fail_rule
      if: input_size >= 0.5
      fail: Too much data, please don't use MAFFT for this.
  toolshed.g2.bx.psu.edu/repos/rnateam/sortmerna/bg_sortmerna/.*:
    context:
      max_concurrent_job_count_for_tool_user: 4
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
    scheduling:
      accept:
      - pulsar
  toolshed.g2.bx.psu.edu/repos/rnateam/targetfinder/targetfinder/.*:
    cores: 4
    mem: 15.3
    params:
      tmp_dir: true
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/simon-gladman/velvetoptimiser/velvetoptimiser/.*:
    cores: 4
    mem: 15.3
    scheduling:
      accept:
      - pulsar
    rules:
    - id: velvetoptimiser_small_input_rule
      if: input_size < 0.015
      cores: 2
      mem: 7.6
    - id: velvetoptimiser_fail_rule
      if: input_size >= 1
      fail: Too much data, please don't use the Velvet Optimiser for this, it is here
        only for training purposes with small (< 1 GB) datasets. Use SPAdes instead.
  toolshed.g2.bx.psu.edu/repos/thanhlv/centrifuge/centrifuge/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/thanhlv/clinker/clinker/.*:
    cores: 1
    mem: 3.8
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/wolma/mimodd.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/wolma/mimodd_aln/mimodd_align/.*:
    cores: 5
    mem: 19.1
    rules:
    - id: mimodd_align_small_input_rule
      if: input_size < 0.01
      cores: 1
      mem: 3.8
  .*bowtie2_index_builder_data_manager.*:
    cores: 16
    mem: 62
  .*bwa_mem_index_builder_data_manager.*:
    cores: 16
    mem: 62
  .*bwameth_index_builder_data_manager.*:
    cores: 5
    mem: 19.1
  .*data_manager.*:
    context:
      singularity_volumes: '$job_directory:rw,$galaxy_root:ro,$tool_directory:ro,/mnt/user-data-volA:ro,/mnt/user-data-volB:ro,/mnt/user-data-volC:ro,/mnt/user-data-volD:ro,/mnt/user-data-qld:ro,/mnt/user-data-pawsey:ro,/mnt/custom-indices:rw,/cvmfs/data.galaxyproject.org:ro,/tmp:rw'
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
  .*data_manager_bwa_mem2_index_builder.*:
    cores: 6
    mem: 125
  .*data_manager_cat.*:
    cores: 5
    mem: 19.1
  .*data_manager_diamond_database_builder.*:
    cores: 5
    mem: 19.1
  .*data_manager_eggnog_mapper_abspath.*:
    cores: 5
    mem: 19.1
  .*data_manager_funannotate.*:
    cores: 5
    mem: 19.1
  .*data_manager_gtdbtk_database_installer.*:
    cores: 5
    mem: 19.1
    params:
      singularity_enabled: true
  .*data_manager_humann2_database_downloader.*:
    cores: 5
    mem: 19.1
  .*data_manager_humann_database_downloader.*:
    cores: 5
    mem: 19.1
  .*data_manager_interproscan.*:
    cores: 5
    mem: 19.1
  .*data_manager_sam_fasta_index_builder.*:
    params:
      singularity_enabled: false
  .*hisat2_index_builder_data_manager.*:
    cores: 5
    mem: 19.1
  .*kraken2_build_database.*:
    cores: 16
    mem: 62
  .*rna_star_index_builder_data_manager.*:
    cores: 32
    mem: 122.8
  .*twobit_builder_data_manager.*:
    cores: 16
    mem: 62
  'Convert characters1':
    mem: 8
  Cut1:
    cores: 1
    mem: 3.8
  Extract genomic DNA 1:
    cores: 3
    mem: 11.5
  Grouping1:
    cores: 1
    mem: 3.8
  Remove beginning1:
    cores: 1
    mem: 3.8
  __DATA_FETCH__:
    context:
      max_concurrent_job_count_for_tool_total: 25
      max_concurrent_job_count_for_tool_user: 4
    cores: 1
    mem: 10
    params:
      tmp_dir: true
  __IMPORT_HISTORY__:
    params:
      tmp_dir: true
  alphafold_test.*:
    context:
      alphafold_db: /data
      pulsar_docker_volumes: $job_directory:ro,$job_directory/home:rw,$tool_directory:ro,$job_directory/outputs:rw,$working_directory:rw,/data/alphafold:/data:ro
    cores: 16
    mem: 130
    params:
      docker_enabled: true
      docker_run_extra_arguments: --gpus all --env ALPHAFOLD_AA_LENGTH_MIN=16 --env
        ALPHAFOLD_AA_LENGTH_MAX=3000 --env ALPHAFOLD_DB={alphafold_db}
      tmp_dir: true
    scheduling:
      require:
      - pulsar
      - pulsar-qld-gpu
      - pulsar-qld-gpu-alphafold

  cat1:
    params:
      tmp_dir: true
  cellranger:
    cores: 6
    mem: 20
    params:
      singularity_enabled: true
    rules:
    - id: cellranger_group_access_rule
      if: |
        not user or not 'cellranger' in [role.name for role in user.all_roles() if not role.deleted]
      fail: Your account has not been given access to cellranger. Contact help@genome.edu.au
        if you think this is in error.
  CONVERTER.*:
    params:
      tmp_dir: true
  CONVERTER_bam_to_bigwig_0:
    inherits: wig_to_bigWig  
  CONVERTER_bedgraph_to_bigwig:
    inherits: wig_to_bigWig
  CONVERTER_fasta_to_fai:
    mem: 10
  CONVERTER_wig_to_bigwig:
    inherits: wig_to_bigWig  
  fgenesh_tool:
    abstract: true
    params:
      singularity_enabled: true
    rules:
    - id: fgenesh_group_access_rule
      if: |
        not user or not 'Fgenesh' in [role.name for role in user.all_roles() if not role.deleted]
      fail: Your account has not been given access to fgenesh. Contact help@genome.edu.au
        if you think this is in error.
  ^fgenesh_annotate$:
    inherits: fgenesh_tool
    cores: 60
    mem: 300
    scheduling:
      accept:
        - pulsar
        - training-exempt  # skips user training role rules within users.yml
      require:
        - pulsar-high-mem2
    rules:
    - id: fgenesh_annotate_training_rule  # custom training rule for fgenesh - regular training rules are in users.yml.j2
      if: |
        user and any([role.name.startswith('training') for role in user.all_roles() if not role.deleted])
      cores: 4
      mem: 25
  fgenesh_merge:
    inherits: fgenesh_tool
  fgenesh_split:
    inherits: fgenesh_tool
  fgenesh_to_genbank:
    inherits: fgenesh_tool
  fgenesh_get_mrnas_gc:
    inherits: fgenesh_tool
  fgenesh_get_proteins:
    inherits: fgenesh_tool
  gtdbtk_classify_wf_test:
    cores: 16
    mem: 60
    params:
      singularity_enabled: true
  interactive_tool_.*:
    context:
      require_login: true
      partition: interactive_tools
    cores: 2
    mem: 7.6
    scheduling:
      require:
      - interactive_pulsar
      accept:
      - training-exempt
  restricted_interactive_tool:
    inherits: interactive_tool_.*
    context:
      interactive_tool_embargo_days: 7      
    rules:
      - id: restricted_interactive_tool_restriction_rule
        if: |
          from datetime import datetime, timedelta
          may_use_ITs = False
          if user:
            threshold = datetime.now() - timedelta(days=interactive_tool_embargo_days)
            if 'trusted_for_ITs' in [r.name for r in user.all_roles() if not r.deleted]:
              may_use_ITs = True
            elif any([r.name.startswith('training') for r in user.all_roles()]):
              may_use_ITs = True
            elif user.create_time < threshold:
              may_use_ITs = True
          not may_use_ITs
        fail:
          'You must wait {interactive_tool_embargo_days} days before being able to use this tool. Please email help@genome.edu.au if you need access sooner or have any questions.'
  interactive_tool_jupyter_notebook:
    inherits: restricted_interactive_tool
  interactive_tool_phyloseq:
    params:
      docker_run_extra_arguments: "--user $UID:$GID"
  interactive_tool_rstudio:
    inherits: restricted_interactive_tool
    params:
      container_override:
      - type: docker
        shell: /bin/bash
        identifier: quay.io/galaxy/docker-rstudio-notebook:24.2
  join1:
    cores: 5
    mem: 19.1
    rules:
    - id: join1_small_input_rule
      if: input_size < 10
      cores: 2
      mem: 7.6
  maxquant_test:
    cores: 120
    mem: 480.5
    scheduling:
      require:
      - pulsar-qld-high-mem1
      accept:
      - pulsar
  random_lines1:
    mem: 16
    params:
      tmp_dir: true
  'Show tail1':
    mem: 10
  sort1:
    params:
      tmp_dir: true
  tabular_to_csv:
    cores: 3
    mem: 11.5
    rules:
    - id: tabular_to_csv_small_input_rule
      if: input_size < 1
      cores: 1
      mem: 3.8
  wig_to_bigWig:
    mem: min(max(input_size * 20, 28), 58)
    scheduling:
      accept:
      - training-exempt   # these jobs are exempt from training rules that would reduce allocated memory
  toolshed.g2.bx.psu.edu/repos/iuc/tbprofiler/tb_profiler_profile/.*:
    cores: 3
    mem: 11.5
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/omark/omark/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/optitype/optitype/.*:
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/iuc/orthofinder_onlygroups/orthofinder_onlygroups/.*:
    context:
      max_concurrent_job_count_for_tool_user: 2
    cores: 8
    mem: 30.7
    params:
      singularity_enabled: true
  toolshed.g2.bx.psu.edu/repos/genouest/helixer/helixer/*:
    cores: 8
    mem: 69
    params:
      singularity_enabled: true
      singularity_run_extra_arguments: --nv
    scheduling:
      accept:
      - pulsar
      - training-exempt
      require:
      - pulsar-qld-gpu4
      - pulsar-qld-gpu-other
      - pulsar-qld-gpu
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/dorado/dorado/.*:
    cores: 8
    mem: 540  # updated from 69 to 130 to lower the concurrency, not because his needs a lot of RAM, the next day updated to 540 so only one will run at once
    gpus: 1
    params:
      singularity_enabled: true
      singularity_run_extra_arguments: --nv
    scheduling:
      accept:
      - pulsar
      - training-exempt
      require:
      - pulsar-qld-gpu5
      - pulsar-qld-gpu-other
      - pulsar-qld-gpu

  toolshed.g2.bx.psu.edu/repos/galaxy-australia/dorado_error_correct/dorado_error_correct/.*:
    inherits: toolshed.g2.bx.psu.edu/repos/galaxy-australia/dorado/dorado/.*
    
  toolshed.g2.bx.psu.edu/repos/galaxy-australia/dorado_pod5_convert/dorado_pod5_convert/.*:
    cores: 8
    params:
      singularity_enabled: true

  toolshed.g2.bx.psu.edu/repos/galaxy-australia/dorado_trimming/dorado_trimming/.*:
    params:
      singularity_enabled: true

  toolshed.g2.bx.psu.edu/repos/galaxy-australia/plot_ragtag_paf/plot_ragtag_paf/.*:
    params:
      singularity_enabled: true

  toolshed.g2.bx.psu.edu/repos/galaxy-australia/aarnet_filesender/aarnet_filesender/.*:
    params:
      singularity_enabled: true
